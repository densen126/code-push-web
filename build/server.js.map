{"version":3,"file":"server.js","mappings":";;;;;;;;;;;;;;;;;;;AAAA;AACA;AAAA;AAMA;AAAA;AAAA;AACA;AACA;AACA;AAEA;;;;;;;;;;;;;;;;;;ACZA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAIA;;;;;;;;;;;;;;;;;;ACxBA;AAAA;AASA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAGA;;;;;;;;;;ACjBA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AAAA;AAGA;AACA;AAEA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AAEA;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","sources":["webpack://code-push-web/./src/components/App.tsx","webpack://code-push-web/./src/components/Html.tsx","webpack://code-push-web/./src/routes/index.tsx","webpack://code-push-web/external commonjs \"express\"","webpack://code-push-web/external commonjs \"react\"","webpack://code-push-web/external commonjs \"react-dom/server\"","webpack://code-push-web/external commonjs \"react/jsx-runtime\"","webpack://code-push-web/webpack/bootstrap","webpack://code-push-web/webpack/runtime/compat get default export","webpack://code-push-web/webpack/runtime/define property getters","webpack://code-push-web/webpack/runtime/hasOwnProperty shorthand","webpack://code-push-web/webpack/runtime/make namespace object","webpack://code-push-web/./src/server.tsx"],"sourcesContent":["import React, { ReactNode } from 'react';\nimport routes from './../routes';\n\ninterface AppProps {\n  currentPath?: ReactNode;\n}\n\nconst App: React.FC<AppProps> = ({ currentPath }) => {\n  const route = routes.find(r => r.path === currentPath) || routes.find(r => r.path === '*')!;\n  return <route.component />;\n};\n\nexport default App;\n","import React, { ReactNode } from 'react';\n\ninterface HtmlProps {\n    children: ReactNode;\n    currentPath: string;\n    title?: string;\n}\n\nconst Html: React.FC<HtmlProps> = ({ children, title = 'SSR App', currentPath = \"/\" }) => (\n    <html lang=\"en\">\n        <head>\n            <meta charSet=\"utf-8\" />\n            <title>{title}</title>\n            <script defer src=\"/public/main.js\"></script>\n        </head>\n        <body>\n            <div id=\"root\" dangerouslySetInnerHTML={{ __html: typeof children === 'string' ? children : '' }} />\n            <script dangerouslySetInnerHTML={{\n                __html: `window.__INITIAL_DATA__ = {path: \"${currentPath}\"};`\n            }} />\n        </body>\n    </html>\n);\n\nexport default Html;\n","import React from 'react';\n\ninterface Route {\n  path: string;\n  component: React.ComponentType;\n  title?: string;\n  status?: number;\n}\n\nconst Home: React.FC = () => <h1>Hello from Home</h1>;\nconst NotFound: React.FC = () => <h1>404 Not Found</h1>;\n\nconst routes: Route[] = [\n  { path: '/', component: Home, title: 'Home', status: 200 },\n  { path: '*', component: NotFound, title: 'Not Found', status: 404 },\n];\n\nexport default routes;\n","module.exports = require(\"express\");","module.exports = require(\"react\");","module.exports = require(\"react-dom/server\");","module.exports = require(\"react/jsx-runtime\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import express from 'express';\nimport React from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport App from './components/App';\nimport Html from './components/Html';\nimport routes from 'routes';\n\nconst app = express();\nconst port = 3000;\n\napp.use('/public', express.static('build/public'));\n\napp.get('/', (req, res) => {\n    const path = req.path;\n    const content = ReactDOMServer.renderToString(<App currentPath={path} />);\n    const html = ReactDOMServer.renderToStaticMarkup(\n        // <Html>\n        //   <div id=\"root\" dangerouslySetInnerHTML={{ __html: content }} />\n        // </Html>\n        <Html title={'Untitled'} currentPath={path}>\n            {content}\n        </Html>\n    );\n    res.send('<!doctype html>' + html);\n});\n\nexport default app;\n\n\n// import express from 'express';\n// import React from 'react';\n// import ReactDOMServer from 'react-dom/server';\n\n// import App from 'components/App';\n// import Html from 'components/Html';\n// import routes from 'routes';\n\n// import { local_host, server_port } from './../config/config';\n\n// const app = express();\n\n// // 静态资源目录\n// // app.use(express.static(path.resolve(__dirname, 'public')));\n\n// app.get('/', async (req, res) => {\n//     try {\n//         // 根据路径找对应路由，没有则用 NotFound\n//         const route = routes.find(r => r.path === req.path) || routes.find(r => r.path === '*');\n\n//         // 渲染对应组件内容\n//         // const content = ReactDOMServer.renderToString(\n//         //     <App>\n//         //         {route?.component ? React.createElement(route.component) : null}\n//         //     </App>\n//         // );\n\n//         const html = ReactDOMServer.renderToStaticMarkup(\n//             <Html title={route?.title || 'Untitled'}>\n//                 <App>\n//                     {route?.component ? React.createElement(route.component) : null}\n//                 </App>\n//             </Html>\n//         );\n\n\n//         // 流式渲染 React 组件，逐步向客户端发送 HTML\n//         // ReactDOMServer.renderToPipeableStream\n//         console.log(`${html}`)\n//         res.status(route?.status || 200).send(`${html}`);\n//     } catch (error) {\n//         console.error('SSR error:', error);\n//         res.status(500).send('Internal Server Error');\n//     }\n// });\n\n// app.listen(server_port, () => {\n//     console.log(`Dev server listening on http://${local_host}:${server_port}`);\n// });\n"],"names":[],"sourceRoot":""}